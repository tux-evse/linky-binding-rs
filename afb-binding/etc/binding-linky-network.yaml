name: afb-linky
no-ldpaths: true
no-httpd: true
log: error+warning+notice
alias:
  - /devtools:/usr/share/afb-ui-devtools/binder
monitoring: false
tracereq: none
extension:
- path: "/usr/redpesk/afb-mqtt/lib/libafb-mqtt-ext.so"
"@extconfig":
  MQTT:
    # mqtt-config-file: "${BASEDIR}/etc/linky-mqtt-config.yaml"
    config: { "$ref": "${BASEDIR}/etc/linky-mqtt-config.yaml" }
binding:
  - uid: linky-meeter
    api: linky
    # permission: acl:linky
    # "path": /usr/redpesk/linky-binding-rs/lib/libafb_linky.so
    path: libafb_linky.so
    # path: ./target/debug/libafb_linky.so
    info: Linky French meeter api
    cycle: 25  # force event each 25s even when value does not change
    network:
      - bind: 0.0.0.0  # default 0.0.0.0
        port: 2000     # no default should be defined
    sensors:
        # IINST:   # 60-90A meeting only
        # ADSC:    # meeting code addr
        URMS:      # effective tension
        IRMS:      # effective current
        UMOY:      # voltage average
        MSG:       # short message
        NTARF:     # current tariff index
        ADPS:      # Avertissent depassement puissance in A
        TARIFF:    # Current Tariff name and label
        ENERGY:    # Total energy meeter
        SINSTS:    # Current used power
        SINSTI:    # Current injected power
        POWER-IN:  # Today time & max power
        POWER-OUT: # Yesterday time & max power
        STGE:      # Linky status register
        DPM1:      # Mobile Pic start
        FPM1:      # Mobile Pic end

